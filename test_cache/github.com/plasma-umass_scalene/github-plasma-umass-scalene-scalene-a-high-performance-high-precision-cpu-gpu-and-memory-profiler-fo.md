---
title: GitHub - plasma-umass/scalene: Scalene: a high-performance, high-precision CPU, GPU, and memory profiler for Python with AI-powered optimization proposals
description: Scalene: a high-performance, high-precision CPU, GPU, and memory profiler for Python with AI-powered optimization proposals - plasma-umass/scalene
url: https://github.com/plasma-umass/scalene
timestamp: 2025-01-20T15:31:34.484Z
domain: github.com
path: plasma-umass_scalene
---

# GitHub - plasma-umass/scalene: Scalene: a high-performance, high-precision CPU, GPU, and memory profiler for Python with AI-powered optimization proposals


Scalene: a high-performance, high-precision CPU, GPU, and memory profiler for Python with AI-powered optimization proposals - plasma-umass/scalene


## Content

[![Image 69: scalene](https://github.com/plasma-umass/scalene/raw/master/docs/scalene-icon-white.png)](https://github.com/plasma-umass/scalene/raw/master/docs/scalene-icon-white.png)

Scalene: a Python CPU+GPU+memory profiler with AI-powered optimization proposals
--------------------------------------------------------------------------------

[](https://github.com/plasma-umass/scalene?screenshot=true#scalene-a-python-cpugpumemory-profiler-with-ai-powered-optimization-proposals)

by [Emery Berger](https://emeryberger.com/), [Sam Stern](https://samstern.me/), and [Juan Altmayer Pizzorno](https://github.com/jaltmayerpizzorno).

[![Image 70: Scalene community Slack](https://github.com/plasma-umass/scalene/raw/master/docs/images/slack-logo.png)](https://join.slack.com/t/scaleneprofil-jge3234/shared_invite/zt-110vzrdck-xJh5d4gHnp5vKXIjYD3Uwg)[Scalene community Slack](https://join.slack.com/t/scaleneprofil-jge3234/shared_invite/zt-110vzrdck-xJh5d4gHnp5vKXIjYD3Uwg)

[![Image 71: PyPI Latest Release](https://camo.githubusercontent.com/999e3fc8d7e5ec0d4b465371620a1cec5dbb7f7fc2591ef1e3e8f7214bea61b0/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f7363616c656e652e737667)](https://pypi.org/project/scalene/)[![Image 72: Anaconda-Server Badge](https://camo.githubusercontent.com/60d006b383bad7470fc7ca8368cf8097b3de4044938a4714a788975dc43041ab/68747470733a2f2f696d672e736869656c64732e696f2f636f6e64612f762f636f6e64612d666f7267652f7363616c656e65)](https://anaconda.org/conda-forge/scalene) [![Image 73: Downloads](https://camo.githubusercontent.com/ecdab4442ec9a2ab4cab1de36bebfb0a5c7bc00f288807723ca673522b4b4dc2/68747470733a2f2f7374617469632e706570792e746563682f62616467652f7363616c656e65)](https://pepy.tech/project/scalene)[![Image 74: Anaconda downloads](https://camo.githubusercontent.com/bc3427e8e678f6da977b954640137ecd09fbaee32bc2b1ae169bec0c48bfd304/68747470733a2f2f696d672e736869656c64732e696f2f636f6e64612f642f636f6e64612d666f7267652f7363616c656e653f6c6f676f3d636f6e6461)](https://anaconda.org/conda-forge/scalene) [![Image 75: Downloads](https://camo.githubusercontent.com/c80e0ee2e6b083f8ec0b720007a5fcca7c7e33a5702f8a91eb8cca4afb65ced7/68747470733a2f2f7374617469632e706570792e746563682f62616467652f7363616c656e652f6d6f6e7468)](https://pepy.tech/project/scalene) [![Image 76: Python versions](https://camo.githubusercontent.com/577e8524ded7f9bd5610662b971236965fbbebbf1dbcf24dd9b695733fea4809/68747470733a2f2f696d672e736869656c64732e696f2f707970692f707976657273696f6e732f7363616c656e652e7376673f7374796c653d666c61742d737175617265)](https://camo.githubusercontent.com/577e8524ded7f9bd5610662b971236965fbbebbf1dbcf24dd9b695733fea4809/68747470733a2f2f696d672e736869656c64732e696f2f707970692f707976657273696f6e732f7363616c656e652e7376673f7374796c653d666c61742d737175617265)[![Image 77: Visual Studio Code Extension version](https://camo.githubusercontent.com/f5a0f652c19744c3680c9e621707576452f929653a982cf216b8ad46962c9ae2/68747470733a2f2f696d672e736869656c64732e696f2f76697375616c2d73747564696f2d6d61726b6574706c6163652f762f656d6572796265726765722e7363616c656e653f6c6f676f3d76697375616c73747564696f636f6465)](https://marketplace.visualstudio.com/items?itemName=EmeryBerger.scalene) [![Image 78: License](https://camo.githubusercontent.com/9e2d96d0196d22379d49dcc59fc3d72685bcf46c4957b9d3eddab0986a132bac/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f706c61736d612d756d6173732f7363616c656e65)](https://camo.githubusercontent.com/9e2d96d0196d22379d49dcc59fc3d72685bcf46c4957b9d3eddab0986a132bac/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f706c61736d612d756d6173732f7363616c656e65) [![Image 79: GitHub Repo stars](https://camo.githubusercontent.com/214558cbd0ec69f52d46ac89ba8209a8a4fa1ed8e6beb5e124a9dd32bfd6854d/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f73746172732f706c61736d612d756d6173732f7363616c656e653f7374796c653d736f6369616c)](https://github.com/plasma-umass/scalene)

[![Image 80: Ozsvald tweet](https://github.com/plasma-umass/scalene/raw/master/docs/Ozsvald-tweet.png)](https://github.com/plasma-umass/scalene/raw/master/docs/Ozsvald-tweet.png)

(tweet from Ian Ozsvald, author of [_High Performance Python_](https://smile.amazon.com/High-Performance-Python-Performant-Programming/dp/1492055026/ref=sr_1_1?crid=texbooks))

[![Image 81: Semantic Scholar success story](https://github.com/plasma-umass/scalene/raw/master/docs/semantic-scholar-success.png)](https://github.com/plasma-umass/scalene/raw/master/docs/semantic-scholar-success.png)

_**Scalene web-based user interface:**_ [http://plasma-umass.org/scalene-gui/](http://plasma-umass.org/scalene-gui/)

About Scalene
-------------

[](https://github.com/plasma-umass/scalene?screenshot=true#about-scalene)

Scalene is a high-performance CPU, GPU _and_ memory profiler for Python that does a number of things that other Python profilers do not and cannot do. It runs orders of magnitude faster than many other profilers while delivering far more detailed information. It is also the first profiler ever to incorporate AI-powered proposed optimizations.

### AI-powered optimization suggestions

[](https://github.com/plasma-umass/scalene?screenshot=true#ai-powered-optimization-suggestions)

> **Note**
> 
> To enable AI-powered optimization suggestions, you need to enter an [OpenAI key](https://openai.com/api/) in the box under "Advanced options". _Your account will need to have a positive balance for this to work_ (check your balance at [https://platform.openai.com/account/usage](https://platform.openai.com/account/usage)).
> 
> [![Image 82: Scalene advanced options](https://user-images.githubusercontent.com/1612723/211639253-ec926b38-3efe-4a20-8514-e10dde94ec01.png)](https://user-images.githubusercontent.com/1612723/211639253-ec926b38-3efe-4a20-8514-e10dde94ec01.png)

Once you've entered your OpenAI key (see above), click on the lightning bolt (âš¡) beside any line or the explosion (ðŸ’¥) for an entire region of code to generate a proposed optimization. Click on a proposed optimization to copy it to the clipboard.

[![Image 83: example proposed optimization](https://user-images.githubusercontent.com/1612723/211639968-37cf793f-3290-43d1-9282-79e579558388.png)](https://user-images.githubusercontent.com/1612723/211639968-37cf793f-3290-43d1-9282-79e579558388.png)

You can click as many times as you like on the lightning bolt or explosion, and it will generate different suggested optimizations. Your mileage may vary, but in some cases, the suggestions are quite impressive (e.g., order-of-magnitude improvements).

### Quick Start

[](https://github.com/plasma-umass/scalene?screenshot=true#quick-start)

#### Installing Scalene:

[](https://github.com/plasma-umass/scalene?screenshot=true#installing-scalene)

python3 -m pip install -U scalene

or

conda install -c conda-forge scalene

#### Using Scalene:

[](https://github.com/plasma-umass/scalene?screenshot=true#using-scalene)

After installing Scalene, you can use Scalene at the command line, or as a Visual Studio Code extension.

Using the Scalene VS Code Extension:First, install [the Scalene extension from the VS Code Marketplace](https://marketplace.visualstudio.com/items?itemName=EmeryBerger.scalene) or by searching for it within VS Code by typing Command-Shift-X (Mac) or Ctrl-Shift-X (Windows). Once that's installed, click Command-Shift-P or Ctrl-Shift-P to open the [Command Palette](https://code.visualstudio.com/docs/getstarted/userinterface). Then select **"Scalene: AI-powered profiling..."** (you can start typing Scalene and it will pop up if it's installed). Run that and, assuming your code runs for at least a second, a Scalene profile will appear in a webview.

[![Image 84: Screenshot 2023-09-20 at 7 09 06 PM](https://private-user-images.githubusercontent.com/1612723/269439965-7e78e3d2-e649-4f02-86fd-0da2a259a1a4.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzczODcwNTgsIm5iZiI6MTczNzM4Njc1OCwicGF0aCI6Ii8xNjEyNzIzLzI2OTQzOTk2NS03ZTc4ZTNkMi1lNjQ5LTRmMDItODZmZC0wZGEyYTI1OWExYTQucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDEyMCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMjBUMTUyNTU4WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9N2UzOWViODE1MDBjYzZkMmVkMDhiNDA3MjRlYmFjNDUzMTBlM2U1MzEyYzQwNTNlODJlNTYwZDBjNzdlYmUyOCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.Dx3u7US5hl90QmN8pDFvcuAJmLx8Qa3jtSmZa9x1h18)](https://private-user-images.githubusercontent.com/1612723/269439965-7e78e3d2-e649-4f02-86fd-0da2a259a1a4.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzczODcwNTgsIm5iZiI6MTczNzM4Njc1OCwicGF0aCI6Ii8xNjEyNzIzLzI2OTQzOTk2NS03ZTc4ZTNkMi1lNjQ5LTRmMDItODZmZC0wZGEyYTI1OWExYTQucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDEyMCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMjBUMTUyNTU4WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9N2UzOWViODE1MDBjYzZkMmVkMDhiNDA3MjRlYmFjNDUzMTBlM2U1MzEyYzQwNTNlODJlNTYwZDBjNzdlYmUyOCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.Dx3u7US5hl90QmN8pDFvcuAJmLx8Qa3jtSmZa9x1h18) Commonly used command-line options:

scalene your\_prog.py                             # full profile (outputs to web interface)
python3 -m scalene your\_prog.py                  # equivalent alternative

scalene --cli your\_prog.py                       # use the command-line only (no web interface)

scalene --cpu your\_prog.py                       # only profile CPU
scalene --cpu --gpu your\_prog.py                 # only profile CPU and GPU
scalene --cpu --gpu --memory your\_prog.py        # profile everything (same as no options)

scalene --reduced-profile your\_prog.py           # only profile lines with significant usage
scalene --profile-interval 5.0 your\_prog.py      # output a new profile every five seconds

scalene (Scalene options) --- your\_prog.py (...) # use --- to tell Scalene to ignore options after that point
scalene --help                                   # lists all options

Using Scalene programmatically in your code:Invoke using `scalene` as above and then:

from scalene import scalene\_profiler

\# Turn profiling on
scalene\_profiler.start()

\# your code

\# Turn profiling off
scalene\_profiler.stop()

from scalene.scalene\_profiler import enable\_profiling

with enable\_profiling():
    \# do something

Using Scalene to profile only specific functions via `@profile`:Just preface any functions you want to profile with the `@profile` decorator and run it with Scalene:

\# do not import profile!

@profile
def slow\_function():
    import time
    time.sleep(3)

#### Web-based GUI

[](https://github.com/plasma-umass/scalene?screenshot=true#web-based-gui)

Scalene has both a CLI and a web-based GUI [(demo here)](http://plasma-umass.org/scalene-gui/).

By default, once Scalene has profiled your program, it will open a tab in a web browser with an interactive user interface (all processing is done locally). Hover over bars to see breakdowns of CPU and memory consumption, and click on underlined column headers to sort the columns. The generated file `profile.html` is self-contained and can be saved for later use.

[![Image 85: Scalene web GUI](https://raw.githubusercontent.com/plasma-umass/scalene/master/docs/scalene-gui-example.png)](https://raw.githubusercontent.com/plasma-umass/scalene/master/docs/scalene-gui-example-full.png)

Scalene Overview
----------------

[](https://github.com/plasma-umass/scalene?screenshot=true#scalene-overview)

### Scalene talk (PyCon US 2021)

[](https://github.com/plasma-umass/scalene?screenshot=true#scalene-talk-pycon-us-2021)

[This talk](https://youtu.be/5iEf-_7mM1k) presented at PyCon 2021 walks through Scalene's advantages and how to use it to debug the performance of an application (and provides some technical details on its internals). We highly recommend watching this video!

[![Image 86: Scalene presentation at PyCon 2021](https://raw.githubusercontent.com/plasma-umass/scalene/master/docs/images/scalene-video-img.png)](https://youtu.be/5iEf-_7mM1k "Scalene presentation at PyCon 2021")

### Fast and Accurate

[](https://github.com/plasma-umass/scalene?screenshot=true#fast-and-accurate)

*   Scalene is **_fast_**. It uses sampling instead of instrumentation or relying on Python's tracing facilities. Its overhead is typically no more than 10-20% (and often less).
    
*   Scalene is **accurate**. We tested CPU profiler accuracy and found that Scalene is among the most accurate profilers, correctly measuring time taken.
    

[![Image 87: Profiler accuracy](https://github.com/plasma-umass/scalene/raw/master/docs/cpu-accuracy-comparison.png)](https://github.com/plasma-umass/scalene/raw/master/docs/cpu-accuracy-comparison.png)

*   Scalene performs profiling **_at the line level_** _and_ **_per function_**, pointing to the functions and the specific lines of code responsible for the execution time in your program.

### CPU profiling

[](https://github.com/plasma-umass/scalene?screenshot=true#cpu-profiling)

*   Scalene **separates out time spent in Python from time in native code** (including libraries). Most Python programmers aren't going to optimize the performance of native code (which is usually either in the Python implementation or external libraries), so this helps developers focus their optimization efforts on the code they can actually improve.
*   Scalene **highlights hotspots** (code accounting for significant percentages of CPU time or memory allocation) in red, making them even easier to spot.
*   Scalene also separates out **system time**, making it easy to find I/O bottlenecks.

### GPU profiling

[](https://github.com/plasma-umass/scalene?screenshot=true#gpu-profiling)

*   Scalene reports **GPU time** (currently limited to NVIDIA-based systems).

### Memory profiling

[](https://github.com/plasma-umass/scalene?screenshot=true#memory-profiling)

*   Scalene **profiles memory usage**. In addition to tracking CPU usage, Scalene also points to the specific lines of code responsible for memory growth. It accomplishes this via an included specialized memory allocator.
*   Scalene separates out the percentage of **memory consumed by Python code vs. native code**.
*   Scalene produces **_per-line_ memory profiles**.
*   Scalene **identifies lines with likely memory leaks**.
*   Scalene **profiles _copying volume_**, making it easy to spot inadvertent copying, especially due to crossing Python/library boundaries (e.g., accidentally converting `numpy` arrays into Python arrays, and vice versa).

### Other features

[](https://github.com/plasma-umass/scalene?screenshot=true#other-features)

*   Scalene can produce **reduced profiles** (via `--reduced-profile`) that only report lines that consume more than 1% of CPU or perform at least 100 allocations.
*   Scalene supports `@profile` decorators to profile only specific functions.
*   When Scalene is profiling a program launched in the background (via `&`), you can **suspend and resume profiling**.

Comparison to Other Profilers
-----------------------------

[](https://github.com/plasma-umass/scalene?screenshot=true#comparison-to-other-profilers)

Performance and Features
------------------------

[](https://github.com/plasma-umass/scalene?screenshot=true#performance-and-features)

Below is a table comparing the **performance and features** of various profilers to Scalene.

[![Image 88: Performance and feature comparison](https://raw.githubusercontent.com/plasma-umass/scalene/master/docs/images/profiler-comparison.png)](https://raw.githubusercontent.com/plasma-umass/scalene/master/docs/images/profiler-comparison.png)

*   **Slowdown**: the slowdown when running a benchmark from the Pyperformance suite. Green means less than 2x overhead. Scalene's overhead is just a 35% slowdown.

Scalene has all of the following features, many of which only Scalene supports:

*   **Lines or functions**: does the profiler report information only for entire functions, or for every line -- Scalene does both.
*   **Unmodified Code**: works on unmodified code.
*   **Threads**: supports Python threads.
*   **Multiprocessing**: supports use of the `multiprocessing` library -- _Scalene only_
*   **Python vs. C time**: breaks out time spent in Python vs. native code (e.g., libraries) -- _Scalene only_
*   **System time**: breaks out system time (e.g., sleeping or performing I/O) -- _Scalene only_
*   **Profiles memory**: reports memory consumption per line / function
*   **GPU**: reports time spent on an NVIDIA GPU (if present) -- _Scalene only_
*   **Memory trends**: reports memory use over time per line / function -- _Scalene only_
*   **Copy volume**: reports megabytes being copied per second -- _Scalene only_
*   **Detects leaks**: automatically pinpoints lines responsible for likely memory leaks -- _Scalene only_

Output
------

[](https://github.com/plasma-umass/scalene?screenshot=true#output)

If you include the `--cli` option, Scalene prints annotated source code for the program being profiled (as text, JSON (`--json`), or HTML (`--html`)) and any modules it uses in the same directory or subdirectories (you can optionally have it `--profile-all` and only include files with at least a `--cpu-percent-threshold` of time). Here is a snippet from `pystone.py`.

[![Image 89: Example profile](https://raw.githubusercontent.com/plasma-umass/scalene/master/docs/images/sample-profile-pystone.png)](https://raw.githubusercontent.com/plasma-umass/scalene/master/docs/images/sample-profile-pystone.png)

*   **Memory usage at the top**: Visualized by "sparklines", memory consumption over the runtime of the profiled code.
*   **"Time Python"**: How much time was spent in Python code.
*   **"native"**: How much time was spent in non-Python code (e.g., libraries written in C/C++).
*   **"system"**: How much time was spent in the system (e.g., I/O).
*   **"GPU"**: (not shown here) How much time spent on the GPU, if your system has an NVIDIA GPU installed.
*   **"Memory Python"**: How much of the memory allocation happened on the Python side of the code, as opposed to in non-Python code (e.g., libraries written in C/C++).
*   **"net"**: Positive net memory numbers indicate total memory allocation in megabytes; negative net memory numbers indicate memory reclamation.
*   **"timeline / %"**: Visualized by "sparklines", memory consumption generated by this line over the program runtime, and the percentages of total memory activity this line represents.
*   **"Copy (MB/s)"**: The amount of megabytes being copied per second (see "About Scalene").

Scalene
-------

[](https://github.com/plasma-umass/scalene?screenshot=true#scalene)

The following command runs Scalene on a provided example program.

Click to see all Scalene's options (available by running with `--help`)

    % scalene --help
     usage: scalene \[-h\] \[--outfile OUTFILE\] \[--html\] \[--reduced-profile\]
                    \[--profile-interval PROFILE\_INTERVAL\] \[--cpu-only\]
                    \[--profile-all\] \[--profile-only PROFILE\_ONLY\]
                    \[--use-virtual-time\]
                    \[--cpu-percent-threshold CPU\_PERCENT\_THRESHOLD\]
                    \[--cpu-sampling-rate CPU\_SAMPLING\_RATE\]
                    \[--malloc-threshold MALLOC\_THRESHOLD\]
     
     Scalene: a high-precision CPU and memory profiler.
     https://github.com/plasma-umass/scalene
     
     command-line:
        % scalene \[options\] yourprogram.py
     or
        % python3 -m scalene \[options\] yourprogram.py
     
     in Jupyter, line mode:
        %scrun \[options\] statement
     
     in Jupyter, cell mode:
        %%scalene \[options\]
        code...
        code...
     
     optional arguments:
       -h, --help            show this help message and exit
       --outfile OUTFILE     file to hold profiler output (default: stdout)
       --html                output as HTML (default: text)
       --reduced-profile     generate a reduced profile, with non-zero lines only (default: False)
       --profile-interval PROFILE\_INTERVAL
                             output profiles every so many seconds (default: inf)
       --cpu-only            only profile CPU time (default: profile CPU, memory, and copying)
       --profile-all         profile all executed code, not just the target program (default: only the target program)
       --profile-only PROFILE\_ONLY
                             profile only code in filenames that contain the given strings, separated by commas (default: no restrictions)
       --use-virtual-time    measure only CPU time, not time spent in I/O or blocking (default: False)
       --cpu-percent-threshold CPU\_PERCENT\_THRESHOLD
                             only report profiles with at least this percent of CPU time (default: 1%)
       --cpu-sampling-rate CPU\_SAMPLING\_RATE
                             CPU sampling rate (default: every 0.01s)
       --malloc-threshold MALLOC\_THRESHOLD
                             only report profiles with at least this many allocations (default: 100)
     
     When running Scalene in the background, you can suspend/resume profiling
     for the process ID that Scalene reports. For example:
     
        % python3 -m scalene \[options\] yourprogram.py &
      Scalene now profiling process 12345
        to suspend profiling: python3 -m scalene.profile --off --pid 12345
        to resume profiling:  python3 -m scalene.profile --on  --pid 12345

### Scalene with Jupyter

[](https://github.com/plasma-umass/scalene?screenshot=true#scalene-with-jupyter)

Instructions for installing and using Scalene with Jupyter notebooks[This notebook](https://nbviewer.jupyter.org/github/plasma-umass/scalene/blob/master/docs/scalene-demo.ipynb) illustrates the use of Scalene in Jupyter.

Installation:

!pip install scalene
%load\_ext scalene

Line mode:

%scrun \[options\] statement

Cell mode:

%%scalene \[options\]
code...
code...

Installation
------------

[](https://github.com/plasma-umass/scalene?screenshot=true#installation)

Using `pip` (Mac OS X, Linux, Windows, and WSL2)Scalene is distributed as a `pip` package and works on Mac OS X, Linux (including Ubuntu in [Windows WSL2](https://docs.microsoft.com/en-us/windows/wsl/wsl2-index)) and (with limitations) Windows platforms.

> **Note**
> 
> The Windows version currently only supports CPU and GPU profiling, but not memory or copy profiling.

You can install it as follows:

or

  % python3 -m pip install -U scalene

You may need to install some packages first.

See [https://stackoverflow.com/a/19344978/4954434](https://stackoverflow.com/a/19344978/4954434) for full instructions for all Linux flavors.

For Ubuntu/Debian:

  % sudo apt install git python3-all-dev

Using `conda` (Mac OS X, Linux, Windows, and WSL2)

  % conda install -c conda-forge scalene

Scalene is distributed as a `conda` package and works on Mac OS X, Linux (including Ubuntu in [Windows WSL2](https://docs.microsoft.com/en-us/windows/wsl/wsl2-index)) and (with limitations) Windows platforms.

> **Note**
> 
> The Windows version currently only supports CPU and GPU profiling, but not memory or copy profiling.

On ArchLinuxYou can install Scalene on Arch Linux via the [AUR package](https://aur.archlinux.org/packages/python-scalene-git/). Use your favorite AUR helper, or manually download the `PKGBUILD` and run `makepkg -cirs` to build. Note that this will place `libscalene.so` in `/usr/lib`; modify the below usage instructions accordingly.

Frequently Asked Questions
--------------------------

[](https://github.com/plasma-umass/scalene?screenshot=true#frequently-asked-questions)

Can I use Scalene with PyTest?**A:** Yes! You can run it as follows (for example):

`python3 -m scalene --- -m pytest your_test.py`

Is there any way to get shorter profiles or do more targeted profiling?**A:** Yes! There are several options:

1.  Use `--reduced-profile` to include only lines and files with memory/CPU/GPU activity.
2.  Use `--profile-only` to include only filenames containing specific strings (as in, `--profile-only foo,bar,baz`).
3.  Decorate functions of interest with `@profile` to have Scalene report _only_ those functions.
4.  Turn profiling on and off programmatically by importing Scalene profiler (`from scalene import scalene_profiler`) and then turning profiling on and off via `scalene_profiler.start()` and `scalene_profiler.stop()`. By default, Scalene runs with profiling on, so to delay profiling until desired, use the `--off` command-line option (`python3 -m scalene --off yourprogram.py`).

How do I run Scalene in PyCharm?**A:** In PyCharm, you can run Scalene at the command line by opening the terminal at the bottom of the IDE and running a Scalene command (e.g., `python -m scalene <your program>`). Use the options `--cli`, `--html`, and `--outfile <your output.html>` to generate an HTML file that you can then view in the IDE.

How do I use Scalene with Django?**A:** Pass in the `--noreload` option (see [#178](https://github.com/plasma-umass/scalene/issues/178)).

Does Scalene work with gevent/Greenlets?**A:** Yes! Put the following code in the beginning of your program, or modify the call to `monkey.patch_all` as below:

from gevent import monkey
monkey.patch\_all(thread\=False)

How do I use Scalene with PyTorch on the Mac?**A:** Scalene works with PyTorch version 1.5.1 on Mac OS X. There's a bug in newer versions of PyTorch ([pytorch/pytorch#57185](https://github.com/pytorch/pytorch/issues/57185)) that interferes with Scalene (discussion here: [#110](https://github.com/plasma-umass/scalene/issues/110)), but only on Macs.

Technical Information
---------------------

[](https://github.com/plasma-umass/scalene?screenshot=true#technical-information)

For details about how Scalene works, please see the following paper, which won the Jay Lepreau Best Paper Award at [OSDI 2023](https://www.usenix.org/conference/osdi23/presentation/berger): [Triangulating Python Performance Issues with Scalene](https://arxiv.org/pdf/2212.07597). (Note that this paper does not include information about the AI-driven proposed optimizations.)

To cite Scalene in an academic paper, please use the following:

@inproceedings{288540,
author = {Emery D. Berger and Sam Stern and Juan Altmayer Pizzorno},
title = {Triangulating Python Performance Issues with {S}calene},
booktitle = {{17th USENIX Symposium on Operating Systems Design and Implementation (OSDI 23)}},
year = {2023},
isbn = {978-1-939133-34-2},
address = {Boston, MA},
pages = {51--64},
url = {https://www.usenix.org/conference/osdi23/presentation/berger},
publisher = {USENIX Association},
month = jul
}

Success Stories
---------------

[](https://github.com/plasma-umass/scalene?screenshot=true#success-stories)

If you use Scalene to successfully debug a performance problem, please [add a comment to this issue](https://github.com/plasma-umass/scalene/issues/58)!

Acknowledgements
----------------

[](https://github.com/plasma-umass/scalene?screenshot=true#acknowledgements)

Logo created by [Sophia Berger](https://www.linkedin.com/in/sophia-berger/).

This material is based upon work supported by the National Science Foundation under Grant No. 1955610. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the National Science Foundation.

## Metadata

```json
{
  "title": "GitHub - plasma-umass/scalene: Scalene: a high-performance, high-precision CPU, GPU, and memory profiler for Python with AI-powered optimization proposals",
  "description": "Scalene: a high-performance, high-precision CPU, GPU, and memory profiler for Python with AI-powered optimization proposals - plasma-umass/scalene",
  "url": "https://github.com/plasma-umass/scalene?screenshot=true",
  "content": "[![Image 69: scalene](https://github.com/plasma-umass/scalene/raw/master/docs/scalene-icon-white.png)](https://github.com/plasma-umass/scalene/raw/master/docs/scalene-icon-white.png)\n\nScalene: a Python CPU+GPU+memory profiler with AI-powered optimization proposals\n--------------------------------------------------------------------------------\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#scalene-a-python-cpugpumemory-profiler-with-ai-powered-optimization-proposals)\n\nby [Emery Berger](https://emeryberger.com/), [Sam Stern](https://samstern.me/), and [Juan Altmayer Pizzorno](https://github.com/jaltmayerpizzorno).\n\n[![Image 70: Scalene community Slack](https://github.com/plasma-umass/scalene/raw/master/docs/images/slack-logo.png)](https://join.slack.com/t/scaleneprofil-jge3234/shared_invite/zt-110vzrdck-xJh5d4gHnp5vKXIjYD3Uwg)[Scalene community Slack](https://join.slack.com/t/scaleneprofil-jge3234/shared_invite/zt-110vzrdck-xJh5d4gHnp5vKXIjYD3Uwg)\n\n[![Image 71: PyPI Latest Release](https://camo.githubusercontent.com/999e3fc8d7e5ec0d4b465371620a1cec5dbb7f7fc2591ef1e3e8f7214bea61b0/68747470733a2f2f696d672e736869656c64732e696f2f707970692f762f7363616c656e652e737667)](https://pypi.org/project/scalene/)[![Image 72: Anaconda-Server Badge](https://camo.githubusercontent.com/60d006b383bad7470fc7ca8368cf8097b3de4044938a4714a788975dc43041ab/68747470733a2f2f696d672e736869656c64732e696f2f636f6e64612f762f636f6e64612d666f7267652f7363616c656e65)](https://anaconda.org/conda-forge/scalene) [![Image 73: Downloads](https://camo.githubusercontent.com/ecdab4442ec9a2ab4cab1de36bebfb0a5c7bc00f288807723ca673522b4b4dc2/68747470733a2f2f7374617469632e706570792e746563682f62616467652f7363616c656e65)](https://pepy.tech/project/scalene)[![Image 74: Anaconda downloads](https://camo.githubusercontent.com/bc3427e8e678f6da977b954640137ecd09fbaee32bc2b1ae169bec0c48bfd304/68747470733a2f2f696d672e736869656c64732e696f2f636f6e64612f642f636f6e64612d666f7267652f7363616c656e653f6c6f676f3d636f6e6461)](https://anaconda.org/conda-forge/scalene) [![Image 75: Downloads](https://camo.githubusercontent.com/c80e0ee2e6b083f8ec0b720007a5fcca7c7e33a5702f8a91eb8cca4afb65ced7/68747470733a2f2f7374617469632e706570792e746563682f62616467652f7363616c656e652f6d6f6e7468)](https://pepy.tech/project/scalene) [![Image 76: Python versions](https://camo.githubusercontent.com/577e8524ded7f9bd5610662b971236965fbbebbf1dbcf24dd9b695733fea4809/68747470733a2f2f696d672e736869656c64732e696f2f707970692f707976657273696f6e732f7363616c656e652e7376673f7374796c653d666c61742d737175617265)](https://camo.githubusercontent.com/577e8524ded7f9bd5610662b971236965fbbebbf1dbcf24dd9b695733fea4809/68747470733a2f2f696d672e736869656c64732e696f2f707970692f707976657273696f6e732f7363616c656e652e7376673f7374796c653d666c61742d737175617265)[![Image 77: Visual Studio Code Extension version](https://camo.githubusercontent.com/f5a0f652c19744c3680c9e621707576452f929653a982cf216b8ad46962c9ae2/68747470733a2f2f696d672e736869656c64732e696f2f76697375616c2d73747564696f2d6d61726b6574706c6163652f762f656d6572796265726765722e7363616c656e653f6c6f676f3d76697375616c73747564696f636f6465)](https://marketplace.visualstudio.com/items?itemName=EmeryBerger.scalene) [![Image 78: License](https://camo.githubusercontent.com/9e2d96d0196d22379d49dcc59fc3d72685bcf46c4957b9d3eddab0986a132bac/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f706c61736d612d756d6173732f7363616c656e65)](https://camo.githubusercontent.com/9e2d96d0196d22379d49dcc59fc3d72685bcf46c4957b9d3eddab0986a132bac/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f6c6963656e73652f706c61736d612d756d6173732f7363616c656e65) [![Image 79: GitHub Repo stars](https://camo.githubusercontent.com/214558cbd0ec69f52d46ac89ba8209a8a4fa1ed8e6beb5e124a9dd32bfd6854d/68747470733a2f2f696d672e736869656c64732e696f2f6769746875622f73746172732f706c61736d612d756d6173732f7363616c656e653f7374796c653d736f6369616c)](https://github.com/plasma-umass/scalene)\n\n[![Image 80: Ozsvald tweet](https://github.com/plasma-umass/scalene/raw/master/docs/Ozsvald-tweet.png)](https://github.com/plasma-umass/scalene/raw/master/docs/Ozsvald-tweet.png)\n\n(tweet from Ian Ozsvald, author of [_High Performance Python_](https://smile.amazon.com/High-Performance-Python-Performant-Programming/dp/1492055026/ref=sr_1_1?crid=texbooks))\n\n[![Image 81: Semantic Scholar success story](https://github.com/plasma-umass/scalene/raw/master/docs/semantic-scholar-success.png)](https://github.com/plasma-umass/scalene/raw/master/docs/semantic-scholar-success.png)\n\n_**Scalene web-based user interface:**_ [http://plasma-umass.org/scalene-gui/](http://plasma-umass.org/scalene-gui/)\n\nAbout Scalene\n-------------\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#about-scalene)\n\nScalene is a high-performance CPU, GPU _and_ memory profiler for Python that does a number of things that other Python profilers do not and cannot do. It runs orders of magnitude faster than many other profilers while delivering far more detailed information. It is also the first profiler ever to incorporate AI-powered proposed optimizations.\n\n### AI-powered optimization suggestions\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#ai-powered-optimization-suggestions)\n\n> **Note**\n> \n> To enable AI-powered optimization suggestions, you need to enter an [OpenAI key](https://openai.com/api/) in the box under \"Advanced options\". _Your account will need to have a positive balance for this to work_ (check your balance at [https://platform.openai.com/account/usage](https://platform.openai.com/account/usage)).\n> \n> [![Image 82: Scalene advanced options](https://user-images.githubusercontent.com/1612723/211639253-ec926b38-3efe-4a20-8514-e10dde94ec01.png)](https://user-images.githubusercontent.com/1612723/211639253-ec926b38-3efe-4a20-8514-e10dde94ec01.png)\n\nOnce you've entered your OpenAI key (see above), click on the lightning bolt (âš¡) beside any line or the explosion (ðŸ’¥) for an entire region of code to generate a proposed optimization. Click on a proposed optimization to copy it to the clipboard.\n\n[![Image 83: example proposed optimization](https://user-images.githubusercontent.com/1612723/211639968-37cf793f-3290-43d1-9282-79e579558388.png)](https://user-images.githubusercontent.com/1612723/211639968-37cf793f-3290-43d1-9282-79e579558388.png)\n\nYou can click as many times as you like on the lightning bolt or explosion, and it will generate different suggested optimizations. Your mileage may vary, but in some cases, the suggestions are quite impressive (e.g., order-of-magnitude improvements).\n\n### Quick Start\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#quick-start)\n\n#### Installing Scalene:\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#installing-scalene)\n\npython3 -m pip install -U scalene\n\nor\n\nconda install -c conda-forge scalene\n\n#### Using Scalene:\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#using-scalene)\n\nAfter installing Scalene, you can use Scalene at the command line, or as a Visual Studio Code extension.\n\nUsing the Scalene VS Code Extension:First, install [the Scalene extension from the VS Code Marketplace](https://marketplace.visualstudio.com/items?itemName=EmeryBerger.scalene) or by searching for it within VS Code by typing Command-Shift-X (Mac) or Ctrl-Shift-X (Windows). Once that's installed, click Command-Shift-P or Ctrl-Shift-P to open the [Command Palette](https://code.visualstudio.com/docs/getstarted/userinterface). Then select **\"Scalene: AI-powered profiling...\"** (you can start typing Scalene and it will pop up if it's installed). Run that and, assuming your code runs for at least a second, a Scalene profile will appear in a webview.\n\n[![Image 84: Screenshot 2023-09-20 at 7 09 06 PM](https://private-user-images.githubusercontent.com/1612723/269439965-7e78e3d2-e649-4f02-86fd-0da2a259a1a4.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzczODcwNTgsIm5iZiI6MTczNzM4Njc1OCwicGF0aCI6Ii8xNjEyNzIzLzI2OTQzOTk2NS03ZTc4ZTNkMi1lNjQ5LTRmMDItODZmZC0wZGEyYTI1OWExYTQucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDEyMCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMjBUMTUyNTU4WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9N2UzOWViODE1MDBjYzZkMmVkMDhiNDA3MjRlYmFjNDUzMTBlM2U1MzEyYzQwNTNlODJlNTYwZDBjNzdlYmUyOCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.Dx3u7US5hl90QmN8pDFvcuAJmLx8Qa3jtSmZa9x1h18)](https://private-user-images.githubusercontent.com/1612723/269439965-7e78e3d2-e649-4f02-86fd-0da2a259a1a4.png?jwt=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJnaXRodWIuY29tIiwiYXVkIjoicmF3LmdpdGh1YnVzZXJjb250ZW50LmNvbSIsImtleSI6ImtleTUiLCJleHAiOjE3MzczODcwNTgsIm5iZiI6MTczNzM4Njc1OCwicGF0aCI6Ii8xNjEyNzIzLzI2OTQzOTk2NS03ZTc4ZTNkMi1lNjQ5LTRmMDItODZmZC0wZGEyYTI1OWExYTQucG5nP1gtQW16LUFsZ29yaXRobT1BV1M0LUhNQUMtU0hBMjU2JlgtQW16LUNyZWRlbnRpYWw9QUtJQVZDT0RZTFNBNTNQUUs0WkElMkYyMDI1MDEyMCUyRnVzLWVhc3QtMSUyRnMzJTJGYXdzNF9yZXF1ZXN0JlgtQW16LURhdGU9MjAyNTAxMjBUMTUyNTU4WiZYLUFtei1FeHBpcmVzPTMwMCZYLUFtei1TaWduYXR1cmU9N2UzOWViODE1MDBjYzZkMmVkMDhiNDA3MjRlYmFjNDUzMTBlM2U1MzEyYzQwNTNlODJlNTYwZDBjNzdlYmUyOCZYLUFtei1TaWduZWRIZWFkZXJzPWhvc3QifQ.Dx3u7US5hl90QmN8pDFvcuAJmLx8Qa3jtSmZa9x1h18) Commonly used command-line options:\n\nscalene your\\_prog.py                             # full profile (outputs to web interface)\npython3 -m scalene your\\_prog.py                  # equivalent alternative\n\nscalene --cli your\\_prog.py                       # use the command-line only (no web interface)\n\nscalene --cpu your\\_prog.py                       # only profile CPU\nscalene --cpu --gpu your\\_prog.py                 # only profile CPU and GPU\nscalene --cpu --gpu --memory your\\_prog.py        # profile everything (same as no options)\n\nscalene --reduced-profile your\\_prog.py           # only profile lines with significant usage\nscalene --profile-interval 5.0 your\\_prog.py      # output a new profile every five seconds\n\nscalene (Scalene options) --- your\\_prog.py (...) # use --- to tell Scalene to ignore options after that point\nscalene --help                                   # lists all options\n\nUsing Scalene programmatically in your code:Invoke using `scalene` as above and then:\n\nfrom scalene import scalene\\_profiler\n\n\\# Turn profiling on\nscalene\\_profiler.start()\n\n\\# your code\n\n\\# Turn profiling off\nscalene\\_profiler.stop()\n\nfrom scalene.scalene\\_profiler import enable\\_profiling\n\nwith enable\\_profiling():\n    \\# do something\n\nUsing Scalene to profile only specific functions via `@profile`:Just preface any functions you want to profile with the `@profile` decorator and run it with Scalene:\n\n\\# do not import profile!\n\n@profile\ndef slow\\_function():\n    import time\n    time.sleep(3)\n\n#### Web-based GUI\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#web-based-gui)\n\nScalene has both a CLI and a web-based GUI [(demo here)](http://plasma-umass.org/scalene-gui/).\n\nBy default, once Scalene has profiled your program, it will open a tab in a web browser with an interactive user interface (all processing is done locally). Hover over bars to see breakdowns of CPU and memory consumption, and click on underlined column headers to sort the columns. The generated file `profile.html` is self-contained and can be saved for later use.\n\n[![Image 85: Scalene web GUI](https://raw.githubusercontent.com/plasma-umass/scalene/master/docs/scalene-gui-example.png)](https://raw.githubusercontent.com/plasma-umass/scalene/master/docs/scalene-gui-example-full.png)\n\nScalene Overview\n----------------\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#scalene-overview)\n\n### Scalene talk (PyCon US 2021)\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#scalene-talk-pycon-us-2021)\n\n[This talk](https://youtu.be/5iEf-_7mM1k) presented at PyCon 2021 walks through Scalene's advantages and how to use it to debug the performance of an application (and provides some technical details on its internals). We highly recommend watching this video!\n\n[![Image 86: Scalene presentation at PyCon 2021](https://raw.githubusercontent.com/plasma-umass/scalene/master/docs/images/scalene-video-img.png)](https://youtu.be/5iEf-_7mM1k \"Scalene presentation at PyCon 2021\")\n\n### Fast and Accurate\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#fast-and-accurate)\n\n*   Scalene is **_fast_**. It uses sampling instead of instrumentation or relying on Python's tracing facilities. Its overhead is typically no more than 10-20% (and often less).\n    \n*   Scalene is **accurate**. We tested CPU profiler accuracy and found that Scalene is among the most accurate profilers, correctly measuring time taken.\n    \n\n[![Image 87: Profiler accuracy](https://github.com/plasma-umass/scalene/raw/master/docs/cpu-accuracy-comparison.png)](https://github.com/plasma-umass/scalene/raw/master/docs/cpu-accuracy-comparison.png)\n\n*   Scalene performs profiling **_at the line level_** _and_ **_per function_**, pointing to the functions and the specific lines of code responsible for the execution time in your program.\n\n### CPU profiling\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#cpu-profiling)\n\n*   Scalene **separates out time spent in Python from time in native code** (including libraries). Most Python programmers aren't going to optimize the performance of native code (which is usually either in the Python implementation or external libraries), so this helps developers focus their optimization efforts on the code they can actually improve.\n*   Scalene **highlights hotspots** (code accounting for significant percentages of CPU time or memory allocation) in red, making them even easier to spot.\n*   Scalene also separates out **system time**, making it easy to find I/O bottlenecks.\n\n### GPU profiling\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#gpu-profiling)\n\n*   Scalene reports **GPU time** (currently limited to NVIDIA-based systems).\n\n### Memory profiling\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#memory-profiling)\n\n*   Scalene **profiles memory usage**. In addition to tracking CPU usage, Scalene also points to the specific lines of code responsible for memory growth. It accomplishes this via an included specialized memory allocator.\n*   Scalene separates out the percentage of **memory consumed by Python code vs. native code**.\n*   Scalene produces **_per-line_ memory profiles**.\n*   Scalene **identifies lines with likely memory leaks**.\n*   Scalene **profiles _copying volume_**, making it easy to spot inadvertent copying, especially due to crossing Python/library boundaries (e.g., accidentally converting `numpy` arrays into Python arrays, and vice versa).\n\n### Other features\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#other-features)\n\n*   Scalene can produce **reduced profiles** (via `--reduced-profile`) that only report lines that consume more than 1% of CPU or perform at least 100 allocations.\n*   Scalene supports `@profile` decorators to profile only specific functions.\n*   When Scalene is profiling a program launched in the background (via `&`), you can **suspend and resume profiling**.\n\nComparison to Other Profilers\n-----------------------------\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#comparison-to-other-profilers)\n\nPerformance and Features\n------------------------\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#performance-and-features)\n\nBelow is a table comparing the **performance and features** of various profilers to Scalene.\n\n[![Image 88: Performance and feature comparison](https://raw.githubusercontent.com/plasma-umass/scalene/master/docs/images/profiler-comparison.png)](https://raw.githubusercontent.com/plasma-umass/scalene/master/docs/images/profiler-comparison.png)\n\n*   **Slowdown**: the slowdown when running a benchmark from the Pyperformance suite. Green means less than 2x overhead. Scalene's overhead is just a 35% slowdown.\n\nScalene has all of the following features, many of which only Scalene supports:\n\n*   **Lines or functions**: does the profiler report information only for entire functions, or for every line -- Scalene does both.\n*   **Unmodified Code**: works on unmodified code.\n*   **Threads**: supports Python threads.\n*   **Multiprocessing**: supports use of the `multiprocessing` library -- _Scalene only_\n*   **Python vs. C time**: breaks out time spent in Python vs. native code (e.g., libraries) -- _Scalene only_\n*   **System time**: breaks out system time (e.g., sleeping or performing I/O) -- _Scalene only_\n*   **Profiles memory**: reports memory consumption per line / function\n*   **GPU**: reports time spent on an NVIDIA GPU (if present) -- _Scalene only_\n*   **Memory trends**: reports memory use over time per line / function -- _Scalene only_\n*   **Copy volume**: reports megabytes being copied per second -- _Scalene only_\n*   **Detects leaks**: automatically pinpoints lines responsible for likely memory leaks -- _Scalene only_\n\nOutput\n------\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#output)\n\nIf you include the `--cli` option, Scalene prints annotated source code for the program being profiled (as text, JSON (`--json`), or HTML (`--html`)) and any modules it uses in the same directory or subdirectories (you can optionally have it `--profile-all` and only include files with at least a `--cpu-percent-threshold` of time). Here is a snippet from `pystone.py`.\n\n[![Image 89: Example profile](https://raw.githubusercontent.com/plasma-umass/scalene/master/docs/images/sample-profile-pystone.png)](https://raw.githubusercontent.com/plasma-umass/scalene/master/docs/images/sample-profile-pystone.png)\n\n*   **Memory usage at the top**: Visualized by \"sparklines\", memory consumption over the runtime of the profiled code.\n*   **\"Time Python\"**: How much time was spent in Python code.\n*   **\"native\"**: How much time was spent in non-Python code (e.g., libraries written in C/C++).\n*   **\"system\"**: How much time was spent in the system (e.g., I/O).\n*   **\"GPU\"**: (not shown here) How much time spent on the GPU, if your system has an NVIDIA GPU installed.\n*   **\"Memory Python\"**: How much of the memory allocation happened on the Python side of the code, as opposed to in non-Python code (e.g., libraries written in C/C++).\n*   **\"net\"**: Positive net memory numbers indicate total memory allocation in megabytes; negative net memory numbers indicate memory reclamation.\n*   **\"timeline / %\"**: Visualized by \"sparklines\", memory consumption generated by this line over the program runtime, and the percentages of total memory activity this line represents.\n*   **\"Copy (MB/s)\"**: The amount of megabytes being copied per second (see \"About Scalene\").\n\nScalene\n-------\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#scalene)\n\nThe following command runs Scalene on a provided example program.\n\nClick to see all Scalene's options (available by running with `--help`)\n\n    % scalene --help\n     usage: scalene \\[-h\\] \\[--outfile OUTFILE\\] \\[--html\\] \\[--reduced-profile\\]\n                    \\[--profile-interval PROFILE\\_INTERVAL\\] \\[--cpu-only\\]\n                    \\[--profile-all\\] \\[--profile-only PROFILE\\_ONLY\\]\n                    \\[--use-virtual-time\\]\n                    \\[--cpu-percent-threshold CPU\\_PERCENT\\_THRESHOLD\\]\n                    \\[--cpu-sampling-rate CPU\\_SAMPLING\\_RATE\\]\n                    \\[--malloc-threshold MALLOC\\_THRESHOLD\\]\n     \n     Scalene: a high-precision CPU and memory profiler.\n     https://github.com/plasma-umass/scalene\n     \n     command-line:\n        % scalene \\[options\\] yourprogram.py\n     or\n        % python3 -m scalene \\[options\\] yourprogram.py\n     \n     in Jupyter, line mode:\n        %scrun \\[options\\] statement\n     \n     in Jupyter, cell mode:\n        %%scalene \\[options\\]\n        code...\n        code...\n     \n     optional arguments:\n       -h, --help            show this help message and exit\n       --outfile OUTFILE     file to hold profiler output (default: stdout)\n       --html                output as HTML (default: text)\n       --reduced-profile     generate a reduced profile, with non-zero lines only (default: False)\n       --profile-interval PROFILE\\_INTERVAL\n                             output profiles every so many seconds (default: inf)\n       --cpu-only            only profile CPU time (default: profile CPU, memory, and copying)\n       --profile-all         profile all executed code, not just the target program (default: only the target program)\n       --profile-only PROFILE\\_ONLY\n                             profile only code in filenames that contain the given strings, separated by commas (default: no restrictions)\n       --use-virtual-time    measure only CPU time, not time spent in I/O or blocking (default: False)\n       --cpu-percent-threshold CPU\\_PERCENT\\_THRESHOLD\n                             only report profiles with at least this percent of CPU time (default: 1%)\n       --cpu-sampling-rate CPU\\_SAMPLING\\_RATE\n                             CPU sampling rate (default: every 0.01s)\n       --malloc-threshold MALLOC\\_THRESHOLD\n                             only report profiles with at least this many allocations (default: 100)\n     \n     When running Scalene in the background, you can suspend/resume profiling\n     for the process ID that Scalene reports. For example:\n     \n        % python3 -m scalene \\[options\\] yourprogram.py &\n      Scalene now profiling process 12345\n        to suspend profiling: python3 -m scalene.profile --off --pid 12345\n        to resume profiling:  python3 -m scalene.profile --on  --pid 12345\n\n### Scalene with Jupyter\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#scalene-with-jupyter)\n\nInstructions for installing and using Scalene with Jupyter notebooks[This notebook](https://nbviewer.jupyter.org/github/plasma-umass/scalene/blob/master/docs/scalene-demo.ipynb) illustrates the use of Scalene in Jupyter.\n\nInstallation:\n\n!pip install scalene\n%load\\_ext scalene\n\nLine mode:\n\n%scrun \\[options\\] statement\n\nCell mode:\n\n%%scalene \\[options\\]\ncode...\ncode...\n\nInstallation\n------------\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#installation)\n\nUsing `pip` (Mac OS X, Linux, Windows, and WSL2)Scalene is distributed as a `pip` package and works on Mac OS X, Linux (including Ubuntu in [Windows WSL2](https://docs.microsoft.com/en-us/windows/wsl/wsl2-index)) and (with limitations) Windows platforms.\n\n> **Note**\n> \n> The Windows version currently only supports CPU and GPU profiling, but not memory or copy profiling.\n\nYou can install it as follows:\n\nor\n\n  % python3 -m pip install -U scalene\n\nYou may need to install some packages first.\n\nSee [https://stackoverflow.com/a/19344978/4954434](https://stackoverflow.com/a/19344978/4954434) for full instructions for all Linux flavors.\n\nFor Ubuntu/Debian:\n\n  % sudo apt install git python3-all-dev\n\nUsing `conda` (Mac OS X, Linux, Windows, and WSL2)\n\n  % conda install -c conda-forge scalene\n\nScalene is distributed as a `conda` package and works on Mac OS X, Linux (including Ubuntu in [Windows WSL2](https://docs.microsoft.com/en-us/windows/wsl/wsl2-index)) and (with limitations) Windows platforms.\n\n> **Note**\n> \n> The Windows version currently only supports CPU and GPU profiling, but not memory or copy profiling.\n\nOn ArchLinuxYou can install Scalene on Arch Linux via the [AUR package](https://aur.archlinux.org/packages/python-scalene-git/). Use your favorite AUR helper, or manually download the `PKGBUILD` and run `makepkg -cirs` to build. Note that this will place `libscalene.so` in `/usr/lib`; modify the below usage instructions accordingly.\n\nFrequently Asked Questions\n--------------------------\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#frequently-asked-questions)\n\nCan I use Scalene with PyTest?**A:** Yes! You can run it as follows (for example):\n\n`python3 -m scalene --- -m pytest your_test.py`\n\nIs there any way to get shorter profiles or do more targeted profiling?**A:** Yes! There are several options:\n\n1.  Use `--reduced-profile` to include only lines and files with memory/CPU/GPU activity.\n2.  Use `--profile-only` to include only filenames containing specific strings (as in, `--profile-only foo,bar,baz`).\n3.  Decorate functions of interest with `@profile` to have Scalene report _only_ those functions.\n4.  Turn profiling on and off programmatically by importing Scalene profiler (`from scalene import scalene_profiler`) and then turning profiling on and off via `scalene_profiler.start()` and `scalene_profiler.stop()`. By default, Scalene runs with profiling on, so to delay profiling until desired, use the `--off` command-line option (`python3 -m scalene --off yourprogram.py`).\n\nHow do I run Scalene in PyCharm?**A:** In PyCharm, you can run Scalene at the command line by opening the terminal at the bottom of the IDE and running a Scalene command (e.g., `python -m scalene <your program>`). Use the options `--cli`, `--html`, and `--outfile <your output.html>` to generate an HTML file that you can then view in the IDE.\n\nHow do I use Scalene with Django?**A:** Pass in the `--noreload` option (see [#178](https://github.com/plasma-umass/scalene/issues/178)).\n\nDoes Scalene work with gevent/Greenlets?**A:** Yes! Put the following code in the beginning of your program, or modify the call to `monkey.patch_all` as below:\n\nfrom gevent import monkey\nmonkey.patch\\_all(thread\\=False)\n\nHow do I use Scalene with PyTorch on the Mac?**A:** Scalene works with PyTorch version 1.5.1 on Mac OS X. There's a bug in newer versions of PyTorch ([pytorch/pytorch#57185](https://github.com/pytorch/pytorch/issues/57185)) that interferes with Scalene (discussion here: [#110](https://github.com/plasma-umass/scalene/issues/110)), but only on Macs.\n\nTechnical Information\n---------------------\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#technical-information)\n\nFor details about how Scalene works, please see the following paper, which won the Jay Lepreau Best Paper Award at [OSDI 2023](https://www.usenix.org/conference/osdi23/presentation/berger): [Triangulating Python Performance Issues with Scalene](https://arxiv.org/pdf/2212.07597). (Note that this paper does not include information about the AI-driven proposed optimizations.)\n\nTo cite Scalene in an academic paper, please use the following:\n\n@inproceedings{288540,\nauthor = {Emery D. Berger and Sam Stern and Juan Altmayer Pizzorno},\ntitle = {Triangulating Python Performance Issues with {S}calene},\nbooktitle = {{17th USENIX Symposium on Operating Systems Design and Implementation (OSDI 23)}},\nyear = {2023},\nisbn = {978-1-939133-34-2},\naddress = {Boston, MA},\npages = {51--64},\nurl = {https://www.usenix.org/conference/osdi23/presentation/berger},\npublisher = {USENIX Association},\nmonth = jul\n}\n\nSuccess Stories\n---------------\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#success-stories)\n\nIf you use Scalene to successfully debug a performance problem, please [add a comment to this issue](https://github.com/plasma-umass/scalene/issues/58)!\n\nAcknowledgements\n----------------\n\n[](https://github.com/plasma-umass/scalene?screenshot=true#acknowledgements)\n\nLogo created by [Sophia Berger](https://www.linkedin.com/in/sophia-berger/).\n\nThis material is based upon work supported by the National Science Foundation under Grant No. 1955610. Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author(s) and do not necessarily reflect the views of the National Science Foundation.",
  "usage": {
    "tokens": 8067
  }
}
```
